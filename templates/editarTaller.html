<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Editar Taller</title>
    <link rel="stylesheet" href="/static/css/estilo.css" />
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Encabezado -->
<nav class="navbar navbar-expand-lg navbar-light bg-light px-4 py-3">
    <img src="{{ url_for('static', filename='img/LOGO UTT.png') }}" alt="Logo UTT" height="150">
    <div class="mx-auto text-center">
        <h4 class="mb-0">Sistema de control y gestión de talleres UTT</h4>
        <small class="text-muted">Universidad Tecnológica de Tlaxcala</small>
    </div>
</nav>
<hr class="linea-negra">
<br>
    <h2 class="titulo-formulario">Editar Taller</h2>

    <form action="{{ url_for('editarTaller', id_taller=taller.id_taller) }}" method="POST" enctype="multipart/form-data">
        <!-- Nombre del Taller -->
        <div class="mb-3">
            <label for="Nombre_T">Nombre Taller</label>
            <input type="text" id="Nombre_T" name="nombre_t"
                value="{{ taller.Nombre_T }}"
                class="{% if 'Nombre_T' in errors %}input-error{% endif %}" required>
            {% if 'Nombre_T' in errors %}
                <div class="error-message">{{ errors['Nombre_T'] }}</div>
            {% endif %}
        </div>

        <!-- Nombre del Docente -->
        <div class="mb-3">
            <label for="Nombre_D">Nombre Docente</label>
            <input type="text" id="Nombre_D" name="nombre_docente"
                value="{{ taller.Nombre_D }}" required>
            {% if 'Nombre_D' in errors %}
                <div class="error-message">{{ errors['Nombre_D'] }}</div>
            {% endif %}
        </div>

        <!-- Días del Taller -->
        <div class="mb-3">
            <label>Días del Taller:</label><br>
            {% set dias = ['Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes'] %}
            {% set dias_taller = taller.Dias_T %}
            {% for dia in dias %}
                <label>
                    <input type="checkbox" name="dias_t[]" value="{{ dia }}"
                        {% if dia in dias_taller %}checked{% endif %}
                        onchange="mostrarHorario('{{ dia }}')"> {{ dia }}
                </label><br>
            {% endfor %}
            <br>
        </div>

        <!-- Contenedor de Horarios -->
        <div class="mb-3">
            <div id="contenedor-horarios"></div>
        </div>

        <!-- Estatus -->
        <div class="mb-3">
            <label for="estatus">Estatus</label>
            <select id="estatus" name="estatus" required>
                <option value="">Selecciona un estatus</option>
                <option value="A" {% if taller.Estatus == 'A' %}selected{% endif %}>Activo</option>
                <option value="B" {% if taller.Estatus == 'B' %}selected{% endif %}>Baja</option>
                <option value="BT" {% if taller.Estatus == 'BT' %}selected{% endif %}>Baja Temporal</option>
            </select>
            {% if 'estatus' in errors %}
                <div class="error-message">{{ errors['estatus'] }}</div>
            {% endif %}
        </div>

        <!-- Botón -->
        <div class="button-container">
            <button type="submit" class="btn">Actualizar registro</button>
        </div>
    </form>

    <!-- JavaScript para mostrar horarios -->
    <script>
        function mostrarHorario(dia, inicio = '', fin = '') {
            const contenedor = document.getElementById("contenedor-horarios");
            const idGrupo = "grupo_" + dia;

            // Si el checkbox fue marcado
            const checkbox = document.querySelector('input[value="' + dia + '"]');
            if (checkbox.checked && !document.getElementById(idGrupo)) {
                const div = document.createElement("div");
                div.id = idGrupo;
                div.innerHTML = `
                    <label>${dia}:</label>
                    <input type="time" name="horario_${dia}_inicio" value="${inicio}" required>
                    <input type="time" name="horario_${dia}_fin" value="${fin}" required><br>
                `;
                contenedor.appendChild(div);
            } else if (!checkbox.checked && document.getElementById(idGrupo)) {
                document.getElementById(idGrupo).remove();
            }
        }

        // Al cargar la página: mostrar horarios precargados
        window.onload = function () {
            const horarios = {{ taller.Horarios | tojson | safe }};
            for (const dia in horarios) {
                const [inicio, fin] = horarios[dia].split('-');
                mostrarHorario(dia, inicio, fin);
                document.querySelector(`input[value="${dia}"]`).checked = true;
            }
        };
    </script>
    <!-- Pie de página -->
<footer class="footer-personalizado text-white text-center mt-5 py-4">
    <div class="container container-footer">
        <div class="row mb-3">
            <div class="col-md-4">
                <p><strong>Comunícate:</strong></p>
                <p>contacto@uttlaxcala.edu.mx</p>
                <p>(247) 47-25-300</p>
                <div>
                    <a href="https://www.facebook.com/share/1ZRmk4uYoG/"><img class="icono-footer" src="{{ url_for('static', filename='img/facebook.png') }}" width="24"></a>
                    <a href="https://www.instagram.com/ut_tlaxcala?igsh=MWNpMjgyNmxvcjNodA=="><img class="icono-footer" src="{{ url_for('static', filename='img/logotipo-de-instagram.png') }}" width="24"></a>
                    <a href="https://chat.whatsapp.com/IuDjMt9CBicDloHkIPTy5F"><img class="icono-footer" src="{{ url_for('static', filename='img/whatsapp.png') }}" width="24"></a>
                </div>
            </div>
            <div class="col-md-4">
                <p><strong>Horario de atención:</strong></p>
                <p>Lunes a Viernes</p>
                <p>09:00 - 17:00 hrs</p>
            </div>
            <div class="col-md-4">
                <p><strong>Ubicación:</strong></p>
                <a href="https://maps.app.goo.gl/Uj8eRuzkXFUboarS7">
        <img src="static/img/mapa.png" alt="Mapa de ubicacion" width="200" height="100"></a>
        </div>
        <p class="texto-copy mt-3 mb-0">© 2025 Taller UTT - Todos los derechos reservados</p>
    </div>
</footer>
</body>
</html>